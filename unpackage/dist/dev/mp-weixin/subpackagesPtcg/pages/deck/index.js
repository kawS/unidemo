"use strict";const e=require("../../../common/vendor.js"),S=require("../../../common/assets.js"),v=require("../../untils/seriesList.js"),g=require("../../untils/baseEList.js"),y=require("./js/fixData.js");Math||(U+j)();const U=()=>"../../../components/emptyList/index.js",j=()=>"../../../components/copyright/index.js",R={__name:"index",setup(q){let m=[],x=0,C=[],L=e.ref([]),p=e.ref(!1),f=e.ref(null),_=e.ref(null),h=e.ref(null),D=e.ref(null),E=e.ref(null);e.onLoad(i=>{const l=e.index.getStorageSync("tempDeck");let t=JSON.parse(l),r=[];D.value=t;for(let n of t){let s=n.substring(0,n.indexOf(" ")+1);/\{G\}/.test(n)&&(n=s+g.baseEList[0]+" 1"),/\{R\}/.test(n)&&(n=s+g.baseEList[1]+" 2"),/\{W\}/.test(n)&&(n=s+g.baseEList[2]+" 3"),/\{L\}/.test(n)&&(n=s+g.baseEList[3]+" 4"),/\{P\}/.test(n)&&(n=s+g.baseEList[4]+" 5"),/\{F\}/.test(n)&&(n=s+g.baseEList[5]+" 6"),/\{D\}/.test(n)&&(n=s+g.baseEList[6]+" 7"),/\{M\}/.test(n)&&(n=s+g.baseEList[7]+" 8"),r.push(n)}E.value=r.length,I(r)});const I=i=>{e.index.showLoading({title:"加载中",mask:!0}),setTimeout(()=>{e.index.hideLoading()},1500);let l={};h.value=[];for(let t of i){let r=t.replace(/(^\d{1,2} )|( \d{1,3}$)/g,"");g.baseEList.includes(r)||r.lastIndexOf(" ");let n=null,s=null,o=null,a=null,u=null,c=null,d=t.match(/(\d{1,2}) (.+) ([A-Z]{2}\-[A-Z]{2}|[A-Z]{3}\-[A-Z]{2}|[A-Z]{3}|[0-9A-Z]{4}|[A-Z]{5}) (\d{1,3})/);if(d==null){if(!/ Energy/.test(t))continue;d=t.match(/(\d{1,2}) (.+) (\d{1,3})/),s=d[1],o=d[2];let b=g.returnEnergyData(o,s);m.push(b);continue}else s=d[1],o=d[2],v.seriesCodeList[d[3]]?(a=d[3],c=d[4]):y.fixCard[o]?(a=y.fixCard[o].series,c=y.fixCard[o].cardNo):(a=d[3],c=d[4]),u=null;if(/-/.test(a)){let b=a.split("-");b[0]!="PR"?(c=`${b[1]} ${c}`,a=b[0]):(c=`${c}`,a=a)}u=v.seriesCodeList[a],u?(l[u]||(l[u]=[]),n={count:s,ename:o,series:a,sNo:u,cardNo:c},l[u].push(n)):h.value.push({count:s,ename:o,series:a,sNo:u,cardNo:c})}x=Object.keys(l).length,e._.isEmpty(l)?$([],[]):N(l)},N=i=>{var t;let l=i;for(let r of v.seriesList)((t=l[r])==null?void 0:t.length)>0&&v.returnSerDetList(r,function(n){$(n.default,l[r])})},$=(i,l,t)=>{let r=[];for(let s of i){let o=null;s.ename=s.ename.replace(/ \(.+\)/,""),o=s.ename;for(let a of l)if(a.cardNo==s.cardNo&&a.ename.replace("’","'").toLowerCase()==o.toLowerCase()){let u=JSON.parse(JSON.stringify(s));u.count=a.count,u.artIndex=-1,r.push(u)}}if(m=[...m,...r],x-=1,x<=0){let s=m.map(u=>u.ename.toLowerCase()),o=e._.difference(C,s);_.value=o.length>0?o:"";let a={p:[],t:[],e:[]};var n=[[],[],[],[],[],[],[],[],[],[],[]];for(let u of m){if(u.type=="Pokemon"){let c=y.typeIndex[`${u.typeEnergy}`].index;n[c].push(u)}u.type=="Trainers"&&a.t.push(u),u.type=="Energy"&&a.e.unshift(u)}a.p=n.flat(),a.t=e._.sortBy(a.t,u=>u.skillList[u.skillList.length-1].name),m=[...a.p,...a.t,...a.e],L.value=m}else{let s=m.map(a=>a.ename.toLowerCase()),o=e._.difference(C,s);_.value=o.length>0?o.join(", "):""}},P=i=>{i.type=="Energy"&&!i.skillList||(i.skillRule=i.skillList.filter(l=>/太晶/g.test(l.name)||/规则/g.test(l.name)),f.value=i,f.value.showImg=f.value.imgUrl,p.value=!0)},w=i=>{f.value.showImg=i},k=()=>{e.index.setClipboardData({data:D.value.join("\r"),success:function(){console.log("success")}})},A=i=>{e.index.navigateTo({url:`/subpackagesPtcg/pages/search/index?searchinp=${encodeURIComponent(i)}`})};return(i,l)=>e.e({a:`overflow: ${e.unref(p)==!0?"hidden":""}`,b:e.t(e.unref(L).length),c:e.unref(_)!=""},e.unref(_)!=""?{d:e.f(e.unref(_),(t,r,n)=>({a:e.t(t),b:r,c:e.o(s=>A(t),r)}))}:{},{e:e.unref(h)!=null&&e.unref(h).length>0},e.unref(h)!=null&&e.unref(h).length>0?{f:e.f(e.unref(h),(t,r,n)=>({a:e.t(t.ename),b:e.t(t.series),c:r}))}:{},{g:e.unref(L).length>0},e.unref(L).length>0?{h:e.f(e.unref(L),(t,r,n)=>({a:t.imgUrl,b:e.t(t.count),c:e.t(t.series),d:t.name,e:e.o(s=>P(t),t.name)})),i:S._imports_0$1}:{},{j:e.t(e.unref(E)),k:e.f(e.unref(D),(t,r,n)=>({a:e.t(t),b:r})),l:e.o(k),m:e.unref(p)},e.unref(p)?e.e({n:e.unref(f).showImg,o:e.unref(f).enImgUrl&&!e.unref(f).isHide},e.unref(f).enImgUrl&&!e.unref(f).isHide?e.e({p:e.unref(f).imgUrl,q:e.o(t=>w(e.unref(f).imgUrl)),r:e.unref(f).isHide!=!0},e.unref(f).isHide!=!0?{s:e.unref(f).enImgUrl,t:e.o(t=>w(e.unref(f).enImgUrl))}:{},{v:e.f(e.unref(f).artList,(t,r,n)=>({a:t,b:e.o(s=>w(t),r),c:r}))}):{},{w:e.unref(f).artList?"":1,x:e.t(e.unref(f).cardName),y:e.t(e.unref(f).ename),z:!/^(基本).*?(能量)$/.test(e.unref(f).cardName)},/^(基本).*?(能量)$/.test(e.unref(f).cardName)?{}:{A:e.f(e.unref(f).skillList,(t,r,n)=>e.e({a:!/太晶/g.test(t.name)&&!/规则/g.test(t.name)},!/太晶/g.test(t.name)&&!/规则/g.test(t.name)?{b:e.t(t.name),c:/太晶/g.test(t.name)?1:"",d:/特性/g.test(t.name)?1:"",e:/规则/g.test(t.name)?1:"",f:/VSTAR力量/g.test(t.name)?1:"",g:e.t(t.effect==""?"-":t.effect)}:{},{h:t.name}))},{B:e.f(e.unref(f).skillRule,(t,r,n)=>({a:e.t(t.name),b:/太晶/g.test(t.name)?1:"",c:/规则/g.test(t.name)?1:"",d:e.t(t.effect==""?"-":t.effect),e:t.name})),C:e.o(t=>e.isRef(p)?p.value=!1:p=!1),D:e.unref(p)?1:""}):{})}},Z=e._export_sfc(R,[["__scopeId","data-v-bc96b40f"],["__file","/Users/kaws-mac/Desktop/unidemo/subpackagesPtcg/pages/deck/index.vue"]]);wx.createPage(Z);
